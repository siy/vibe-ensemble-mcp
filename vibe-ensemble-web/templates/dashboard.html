{% extends "base.html" %}

{% block title %}Dashboard - Vibe Ensemble{% endblock %}

{% block content %}
<div class="grid grid-4">
    <div class="card stat-card">
        <div class="stat-number" id="agents-count">{{ stats.agents_count }}</div>
        <div class="stat-label">Active Agents</div>
    </div>
    <div class="card stat-card">
        <div class="stat-number" id="issues-count">{{ stats.issues_count }}</div>
        <div class="stat-label">Total Issues</div>
    </div>
    <div class="card stat-card">
        <div class="stat-number" id="messages-count">{{ stats.messages_count }}</div>
        <div class="stat-label">Messages Exchanged</div>
    </div>
    <div class="card stat-card">
        <div class="stat-number" id="knowledge-count">{{ stats.knowledge_count }}</div>
        <div class="stat-label">Knowledge Entries</div>
    </div>
</div>

<div class="grid grid-2">
    <div class="card">
        <h3>Recent Activity</h3>
        <div class="alert alert-info">
            <strong>System Status:</strong> All services operational
        </div>
        <ul style="margin: 0; padding-left: 20px;">
            <li>Web interface started successfully</li>
            <li>Database connection established</li>
            <li>WebSocket service initialized</li>
            <li>Authentication service active</li>
        </ul>
    </div>

    <div class="card">
        <h3>Quick Actions</h3>
        <div style="margin-top: 15px;">
            <a href="/issues/new" class="btn btn-primary" style="margin-right: 10px; margin-bottom: 10px;">Create New Issue</a>
            <a href="/knowledge/new" class="btn btn-secondary" style="margin-right: 10px; margin-bottom: 10px;">Add Knowledge</a>
            <a href="/agents" class="btn btn-primary" style="margin-right: 10px; margin-bottom: 10px;">View Agents</a>
            <a href="/api/stats" class="btn btn-secondary" style="margin-bottom: 10px;">API Statistics</a>
        </div>
    </div>
</div>

<div class="card">
    <h3>System Overview</h3>
    <div class="grid grid-3">
        <div>
            <h4 style="margin-bottom: 10px; color: var(--gray-700);">Agent Management</h4>
            <ul style="margin: 0; padding-left: 20px; color: var(--gray-600);">
                <li>Registration and lifecycle tracking</li>
                <li>Capability management</li>
                <li>Real-time status monitoring</li>
            </ul>
        </div>
        <div>
            <h4 style="margin-bottom: 10px; color: var(--gray-700);">Issue Tracking</h4>
            <ul style="margin: 0; padding-left: 20px; color: var(--gray-600);">
                <li>Persistent task management</li>
                <li>Priority-based workflow</li>
                <li>Agent assignment</li>
            </ul>
        </div>
        <div>
            <h4 style="margin-bottom: 10px; color: var(--gray-700);">Knowledge Repository</h4>
            <ul style="margin: 0; padding-left: 20px; color: var(--gray-600);">
                <li>Development patterns storage</li>
                <li>Best practices documentation</li>
                <li>Searchable content</li>
            </ul>
        </div>
    </div>
</div>

{% if recent_issues %}
<div class="card">
    <h3>Recent Issues</h3>
    <table class="table">
        <thead>
            <tr>
                <th>Title</th>
                <th>Priority</th>
                <th>Status</th>
                <th>Created</th>
                <th>Actions</th>
            </tr>
        </thead>
        <tbody>
            {% for issue in recent_issues %}
            <tr>
                <td>{{ issue.title }}</td>
                <td><span class="priority-{{ issue.priority|lower }}">{{ issue.priority }}</span></td>
                <td><span class="status status-{{ issue.status|lower|replace(" ", "-") }}">{{ issue.status }}</span></td>
                <td>{{ issue.created_at|date("%Y-%m-%d %H:%M") }}</td>
                <td><a href="/issues/{{ issue.id }}" class="btn btn-sm btn-primary">View</a></td>
            </tr>
            {% endfor %}
        </tbody>
    </table>
    <div style="text-align: right; margin-top: 15px;">
        <a href="/issues" class="btn btn-secondary">View All Issues</a>
    </div>
</div>
{% endif %}

{% endblock %}

{% block extra_script %}
// Auto-refresh dashboard every 30 seconds
setTimeout(() => {
    window.location.reload();
}, 30000);
{% endblock %}